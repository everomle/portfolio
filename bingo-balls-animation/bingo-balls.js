function init(){canvas=document.getElementById("canvas"),document.onmousedown=onDocumentMouseDown,document.onmouseup=onDocumentMouseUp,document.onmousemove=onDocumentMouseMove,document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1),document.addEventListener("touchend",onDocumentTouchEnd,!1),window.addEventListener("deviceorientation",onWindowDeviceOrientation,!1),worldAABB=new b2AABB,worldAABB.minVertex.Set(-200,-200),worldAABB.maxVertex.Set(window.innerWidth+200,693),world=new b2World(worldAABB,new b2Vec2(0,0),!0),setWalls(),reset()}function play(){setInterval(loop,25)}function reset(){var a;if(bodies)for(a=0;a<bodies.length;a++){var b=bodies[a];canvas.removeChild(b.GetUserData().element),world.DestroyBody(b),b=null}bodies=[],elements=[],createBingoBall(),setTimeout(function(){BingoBall2()},2e3)}function onDocumentMouseDown(){return isMouseDown=!0,!1}function onDocumentMouseUp(){return isMouseDown=!1,!1}function onDocumentMouseMove(a){mouse.x=a.clientX,mouse.y=a.clientY}function onDocumentTouchStart(a){if(1==a.touches.length){a.preventDefault();var b=(new Date).getTime();if(250>b-timeOfLastTouch)return void reset();timeOfLastTouch=b,mouse.x=a.touches[0].pageX,mouse.y=a.touches[0].pageY,isMouseDown=!0}}function onDocumentTouchMove(a){1==a.touches.length&&(a.preventDefault(),mouse.x=a.touches[0].pageX,mouse.y=a.touches[0].pageY)}function onDocumentTouchEnd(a){0==a.touches.length&&(a.preventDefault(),isMouseDown=!1)}function onWindowDeviceOrientation(a){a.beta&&(gravity.x=Math.sin(a.gamma*Math.PI/180),gravity.y=Math.sin(Math.PI/4+a.beta*Math.PI/180))}function createBingoBall(a,b){var a=a||Math.random()*stage[2],b=b||-200*Math.random(),c=110,d=document.createElement("div");d.width=c,d.height=c,d.id="ball1",d.style.position="absolute",d.style.left="-200px",d.style.top="-200px",d.style.cursor="default",canvas.appendChild(d),elements.push(d),bimage=document.createElement("div"),bimage.onSelectStart=null,bimage.innerHTML='<img src="http://media.thebingoaffiliates.com/sites/schedule-designers/7.png" width="110" height="110">',bimage.style.position="absolute",bimage.style.left="0px",bimage.style.top="0px",d.appendChild(bimage);var e=new b2BodyDef,f=new b2CircleDef;f.radius=c>>1,f.density=1,f.friction=.3,f.restitution=.6,e.AddShape(f),e.userData={element:d},e.position.Set(a,b),e.linearVelocity.Set(400*Math.random()-200,400*Math.random()-200),bodies.push(world.CreateBody(e))}function BingoBall2(a,b){var a=a||Math.random()*stage[2],b=b||-200*Math.random(),c=120,d=document.createElement("div");d.width=c,d.height=c,d.id="ball2",d.style.position="absolute",d.style.left="-200px",d.style.top="-200px",d.style.cursor="default",canvas.appendChild(d),elements.push(d),ball2=document.createElement("div"),ball2.onSelectStart=null,ball2.innerHTML='<img src="http://media.thebingoaffiliates.com/sites/schedule-designers/2.png" width="120" height="120">',ball2.style.position="absolute",ball2.style.left="0px",ball2.style.top="0px",d.appendChild(ball2);var e=new b2BodyDef,f=new b2CircleDef;f.radius=c>>1,f.density=1,f.friction=.3,f.restitution=.6,e.AddShape(f),e.userData={element:d},e.position.Set(a,b),e.linearVelocity.Set(400*Math.random()-200,400*Math.random()-200),bodies.push(world.CreateBody(e))}function loop(){for(getBrowserDimensions()&&setWalls(),delta[0]+=.5*(0-delta[0]),delta[1]+=.5*(0-delta[1]),world.m_gravity.x=350*gravity.x+delta[0],world.m_gravity.y=350*gravity.y+delta[1],mouseDrag(),world.Step(timeStep,iterations),i=0;i<bodies.length;i++){var a=bodies[i],b=elements[i];if(b.style.left=a.m_position0.x-(b.width>>1)+"px",b.style.top=a.m_position0.y-(b.height>>1)+"px","ball2"==b.id){var c="rotate("+57.2957795*a.m_rotation0+"deg)";ball2.style.WebkitTransform=c,ball2.style.MozTransform=c,ball2.style.OTransform=c,ball2.style.msTransform=c}if("ball1"==b.id){var d="rotate("+57.2957795*a.m_rotation0+"deg)";bimage.style.WebkitTransform=d,bimage.style.MozTransform=d,bimage.style.OTransform=d,bimage.style.msTransform=d}}}function createBox(a,b,c,d,e,f){"undefined"==typeof f&&(f=!0);var g=new b2BoxDef;f||(g.density=1),g.extents.Set(d,e);var h=new b2BodyDef;return h.AddShape(g),h.position.Set(b,c),a.CreateBody(h)}function mouseDrag(){if(isMouseDown&&!mouseJoint){var a=getBodyAtMouse();if(a){var b=new b2MouseJointDef;b.body1=world.m_groundBody,b.body2=a,b.target.Set(mouse.x,mouse.y),b.maxForce=3e4*a.m_mass,b.timeStep=timeStep,mouseJoint=world.CreateJoint(b),a.WakeUp()}else createMode=!0}if(isMouseDown||(createMode=!1,destroyMode=!1,mouseJoint&&(world.DestroyJoint(mouseJoint),mouseJoint=null)),mouseJoint){var c=new b2Vec2(mouse.x,mouse.y);mouseJoint.SetTarget(c)}}function getBodyAtMouse(){var a=new b2Vec2;a.Set(mouse.x,mouse.y);var b=new b2AABB;b.minVertex.Set(mouse.x-1,mouse.y-1),b.maxVertex.Set(mouse.x+1,mouse.y+1);for(var c=10,d=new Array,e=world.Query(b,d,c),f=null,g=0;e>g;++g)if(0==d[g].m_body.IsStatic()&&d[g].TestPoint(a)){f=d[g].m_body;break}return f}function setWalls(){wallsSetted&&(world.DestroyBody(walls[0]),world.DestroyBody(walls[1]),world.DestroyBody(walls[2]),world.DestroyBody(walls[3]),walls[0]=null,walls[1]=null,walls[2]=null,walls[3]=null),walls[0]=createBox(world,stage[2]/2,-wall_thickness,stage[2],wall_thickness),walls[1]=createBox(world,stage[2]/2,stage[3]+wall_thickness,stage[2],wall_thickness),walls[2]=createBox(world,-wall_thickness,stage[3]/2,wall_thickness,stage[3]),walls[3]=createBox(world,stage[2]+wall_thickness,stage[3]/2,wall_thickness,stage[3]),wallsSetted=!0}function getBrowserDimensions(){var a=!1;return stage[0]!=window.screenX&&(delta[0]=50*(window.screenX-stage[0]),stage[0]=window.screenX,a=!0),stage[1]!=window.screenY&&(delta[1]=50*(window.screenY-stage[1]),stage[1]=window.screenY,a=!0),stage[2]!=window.innerWidth&&(stage[2]=window.innerWidth,a=!0),493!=stage[3]&&(stage[3]=493,a=!0),a}var canvas,delta=[0,0],stage=[window.screenX,window.screenY,window.innerWidth,493],worldAABB,world,iterations=1,timeStep=.05,walls=[],wall_thickness=200,wallsSetted=!1,bodies,elements,text,bimage,ball2,ball1,createMode=!1,destroyMode=!1,isMouseDown=!1,mouseJoint,mouse={x:0,y:0},gravity={x:0,y:1},PI2=2*Math.PI,timeOfLastTouch=0;init(),play();